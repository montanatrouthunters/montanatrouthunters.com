name: 'Generate and deploy'
# From https://swharden.com/blog/2022-03-20-github-actions-hugo/
on:
  workflow_dispatch:
  push:
env:
  LANG: 'en_US.UTF-8'
  LANGUAGE: 'en_US:en'
  LC_ALL: 'en_US.UTF-8'
jobs:
  quality:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        hugo-version:
          - 'latest'

    steps:
      - uses: actions/checkout@v3

      - name: Setup Hugo ðŸ’¡
        uses: peaceiris/actions-hugo@v2
        with:
          hugo-version: ${{ matrix.hugo-version }}
          extended: true

      - uses: actions/checkout@v3

      - name: Proof HTML ðŸ“š
        run: hugo --gc --minify -e production -v -b https://example.com/

      - name: Check HTML
        uses: chabad360/htmlproofer@master
        with:
          directory: './public'
          arguments: --allow-hash-href=true --ignore-empty-alt=true --disable-external=true --ignore-empty-mailto=true
